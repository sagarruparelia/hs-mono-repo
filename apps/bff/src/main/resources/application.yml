spring:
  application:
    name: hs-mono-repo-bff

  # Server Configuration
  server:
    port: ${SERVER_PORT:8080}
    servlet:
      context-path: ${SERVER_SERVLET_CONTEXT_PATH:/}
      session:
        cookie:
          http-only: true
          secure: true
          same-site: lax
          max-age: 30m

  # MongoDB Configuration
  data:
    mongodb:
      uri: ${SPRING_DATA_MONGODB_URI:mongodb://admin:password123@localhost:27017/hs_mono_repo?authSource=admin}
      database: ${SPRING_DATA_MONGODB_DATABASE:hs_mono_repo}

    # Redis Configuration
    redis:
      host: ${SPRING_DATA_REDIS_HOST:localhost}
      port: ${SPRING_DATA_REDIS_PORT:6379}
      password: ${SPRING_DATA_REDIS_PASSWORD:redis123}
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
          max-wait: -1ms

  # Session Configuration
  session:
    store-type: redis
    redis:
      namespace: spring:session
      flush-mode: on_save
    timeout: ${SESSION_TIMEOUT_MINUTES:30}m

  # Security - OAuth2 Client Configuration
  security:
    oauth2:
      client:
        registration:
          idp:
            client-id: ${SPRING_SECURITY_OAUTH2_CLIENT_REGISTRATION_IDP_CLIENT_ID:your-client-id}
            client-secret: ${SPRING_SECURITY_OAUTH2_CLIENT_REGISTRATION_IDP_CLIENT_SECRET:your-client-secret}
            scope: ${SPRING_SECURITY_OAUTH2_CLIENT_REGISTRATION_IDP_SCOPE:openid,profile,email}
            authorization-grant-type: ${SPRING_SECURITY_OAUTH2_CLIENT_REGISTRATION_IDP_AUTHORIZATION_GRANT_TYPE:authorization_code}
            redirect-uri: ${SPRING_SECURITY_OAUTH2_CLIENT_REGISTRATION_IDP_REDIRECT_URI:http://localhost:4202/auth/callback}

        provider:
          idp:
            issuer-uri: ${SPRING_SECURITY_OAUTH2_CLIENT_PROVIDER_IDP_ISSUER_URI:https://your-idp.example.com}
            authorization-uri: ${SPRING_SECURITY_OAUTH2_CLIENT_PROVIDER_IDP_AUTHORIZATION_URI:https://your-idp.example.com/oauth2/authorize}
            token-uri: ${SPRING_SECURITY_OAUTH2_CLIENT_PROVIDER_IDP_TOKEN_URI:https://your-idp.example.com/oauth2/token}
            user-info-uri: ${SPRING_SECURITY_OAUTH2_CLIENT_PROVIDER_IDP_USER_INFO_URI:https://your-idp.example.com/oauth2/userinfo}
            jwk-set-uri: ${SPRING_SECURITY_OAUTH2_CLIENT_PROVIDER_IDP_JWK_SET_URI:https://your-idp.example.com/oauth2/jwks}
            user-name-attribute: sub

# Custom Session Configuration
session:
  timeout:
    minutes: ${SESSION_TIMEOUT_MINUTES:30}
  refresh:
    threshold:
      seconds: ${SESSION_REFRESH_THRESHOLD_SECONDS:300}

# Logging Configuration
logging:
  level:
    root: ${LOGGING_LEVEL_ROOT:INFO}
    com.example.demo: ${LOGGING_LEVEL_COM_EXAMPLE_DEMO:DEBUG}
    org.springframework.security: ${LOGGING_LEVEL_SPRING_SECURITY:DEBUG}
    org.springframework.web: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
      base-path: /actuator
  endpoint:
    health:
      show-details: when-authorized

# Active Profile
---
spring:
  config:
    activate:
      on-profile: development

  # Development-specific settings
  devtools:
    restart:
      enabled: true
    livereload:
      enabled: true

logging:
  level:
    com.example.demo: DEBUG
    org.springframework.security: DEBUG

---
spring:
  config:
    activate:
      on-profile: staging

  # Staging-specific settings
  server:
    servlet:
      session:
        cookie:
          secure: true
          domain: .staging.example.com

logging:
  level:
    com.example.demo: INFO
    org.springframework.security: INFO

---
spring:
  config:
    activate:
      on-profile: production

  # Production-specific settings
  server:
    servlet:
      session:
        cookie:
          secure: true
          domain: .example.com

logging:
  level:
    root: WARN
    com.example.demo: INFO
    org.springframework.security: WARN
